{"version":3,"sources":["webpack:///path---2014-03-04-utilisation-du-statsdbundle-avec-la-console-0c546b3503199875b9f0.js","webpack:///./.cache/json/2014-03-04-utilisation-du-statsdbundle-avec-la-console.json"],"names":["webpackJsonp","./node_modules/json-loader/index.js!./.cache/json/2014-03-04-utilisation-du-statsdbundle-avec-la-console.json","module","exports","data","markdownRemark","ast","frontmatter","date","path","title","image","childImageSharp","resize","src","pathContext"],"mappings":"AAAAA,cAAc,qBAERC,gHACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,IAAA,y/TAA6gXC,aAAiBC,KAAA,iBAAAC,KAAA,0DAAAC,MAAA,wDAAAC,OAAkKC,iBAAmBC,QAAUC,IAAA,2DAAgEC","file":"path---2014-03-04-utilisation-du-statsdbundle-avec-la-console-0c546b3503199875b9f0.js","sourcesContent":["webpackJsonp([7733466120289764000],{\n\n/***/ \"./node_modules/json-loader/index.js!./.cache/json/2014-03-04-utilisation-du-statsdbundle-avec-la-console.json\":\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"markdownRemark\":{\"ast\":\"{\\\"type\\\":\\\"root\\\",\\\"children\\\":[{\\\"type\\\":\\\"heading\\\",\\\"depth\\\":2,\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Le StatsdBundle\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":2,\\\"column\\\":4,\\\"offset\\\":4},\\\"end\\\":{\\\"line\\\":2,\\\"column\\\":19,\\\"offset\\\":19},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":2,\\\"column\\\":1,\\\"offset\\\":1},\\\"end\\\":{\\\"line\\\":2,\\\"column\\\":19,\\\"offset\\\":19},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Chez M6Web, nous \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":1,\\\"offset\\\":21},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":18,\\\"offset\\\":38},\\\"indent\\\":[]}},{\\\"type\\\":\\\"link\\\",\\\"title\\\":null,\\\"url\\\":\\\"{% post_url 2014-01-28-how-we-use-statsd %}\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"utilisons StatsD\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":19,\\\"offset\\\":39},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":35,\\\"offset\\\":55},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":18,\\\"offset\\\":38},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":81,\\\"offset\\\":101},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" et nous avons créé un \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":81,\\\"offset\\\":101},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":104,\\\"offset\\\":124},\\\"indent\\\":[]}},{\\\"type\\\":\\\"link\\\",\\\"title\\\":null,\\\"url\\\":\\\"https://github.com/M6Web/StatsdBundle\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"bundle\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":105,\\\"offset\\\":125},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":111,\\\"offset\\\":131},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":104,\\\"offset\\\":124},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":151,\\\"offset\\\":171},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" pour cela.\\\\nCe bundle permet d'ajouter facilement des incréments et des timings dans StatsD sur des événements Symfony2.\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":151,\\\"offset\\\":171},\\\"end\\\":{\\\"line\\\":5,\\\"column\\\":109,\\\"offset\\\":291},\\\"indent\\\":[1]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":1,\\\"offset\\\":21},\\\"end\\\":{\\\"line\\\":5,\\\"column\\\":109,\\\"offset\\\":291},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"heading\\\",\\\"depth\\\":2,\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"De la Request à la console\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":7,\\\"column\\\":4,\\\"offset\\\":296},\\\"end\\\":{\\\"line\\\":7,\\\"column\\\":30,\\\"offset\\\":322},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":7,\\\"column\\\":1,\\\"offset\\\":293},\\\"end\\\":{\\\"line\\\":7,\\\"column\\\":30,\\\"offset\\\":322},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Or pour des raisons de performances, lors des événements Symfony, les incréments et timings sont seulement stockés dans une variable et ne sont envoyés réellement à StatsD que pendant le \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":1,\\\"offset\\\":324},\\\"end\\\":{\\\"line\\\":9,\\\"column\\\":188,\\\"offset\\\":511},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"kernel.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":188,\\\"offset\\\":511},\\\"end\\\":{\\\"line\\\":9,\\\"column\\\":206,\\\"offset\\\":529},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" qui se déroule après l'envoi de la réponse HTTP au client.\\\\nCeci pose un problème pour les événements lancés depuis une commande Symfony puisque en console, il n'y pas de \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":206,\\\"offset\\\":529},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":112,\\\"offset\\\":700},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"Request\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":112,\\\"offset\\\":700},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":121,\\\"offset\\\":709},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" et donc pas de \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":121,\\\"offset\\\":709},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":137,\\\"offset\\\":725},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"kernel.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":137,\\\"offset\\\":725},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":155,\\\"offset\\\":743},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\".\\\\nNous avons envisagé d'utiliser l'événement \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":155,\\\"offset\\\":743},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":44,\\\"offset\\\":788},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"console.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":11,\\\"column\\\":44,\\\"offset\\\":788},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":63,\\\"offset\\\":807},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" pour palier à cela, mais cela pose deux problèmes :\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":11,\\\"column\\\":63,\\\"offset\\\":807},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":115,\\\"offset\\\":859},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":1,\\\"offset\\\":324},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":115,\\\"offset\\\":859},\\\"indent\\\":[1,1]}},{\\\"type\\\":\\\"list\\\",\\\"ordered\\\":false,\\\"start\\\":null,\\\"loose\\\":false,\\\"children\\\":[{\\\"type\\\":\\\"listItem\\\",\\\"loose\\\":false,\\\"checked\\\":null,\\\"children\\\":[{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"pour une commande qui est censée tourner indéfiniment (par exemple un \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":3,\\\"offset\\\":863},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":73,\\\"offset\\\":933},\\\"indent\\\":[]}},{\\\"type\\\":\\\"emphasis\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"consumer\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":74,\\\"offset\\\":934},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":82,\\\"offset\\\":942},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":73,\\\"offset\\\":933},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":83,\\\"offset\\\":943},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"), on ne veut pas attendre la fin de la commande pour envoyer les données,\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":83,\\\"offset\\\":943},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":157,\\\"offset\\\":1017},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":3,\\\"offset\\\":863},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":157,\\\"offset\\\":1017},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":1,\\\"offset\\\":861},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":157,\\\"offset\\\":1017},\\\"indent\\\":[]}},{\\\"type\\\":\\\"listItem\\\",\\\"loose\\\":false,\\\"checked\\\":null,\\\"children\\\":[{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"dans le cas d'une exception pendant la commande, l'événement \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":3,\\\"offset\\\":1020},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":64,\\\"offset\\\":1081},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"console.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":64,\\\"offset\\\":1081},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":83,\\\"offset\\\":1100},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" est lancé avant \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":83,\\\"offset\\\":1100},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":100,\\\"offset\\\":1117},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"console.exception\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":100,\\\"offset\\\":1117},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":119,\\\"offset\\\":1136},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\".\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":119,\\\"offset\\\":1136},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":3,\\\"offset\\\":1020},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":1,\\\"offset\\\":1018},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":1,\\\"offset\\\":861},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"La première solution était donc d'appeler manuellement \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":1,\\\"offset\\\":1139},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":56,\\\"offset\\\":1194},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"$container->get('m6_statsd')->send()\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":56,\\\"offset\\\":1194},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":94,\\\"offset\\\":1232},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" dans la commande ou dans un \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":94,\\\"offset\\\":1232},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":123,\\\"offset\\\":1261},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"ConsoleExceptionListener\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":123,\\\"offset\\\":1261},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":149,\\\"offset\\\":1287},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" mais cela nous fait perdre le principal intérêt du StatsdBundle à savoir le découplage entre la commande et le client StatsD.\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":149,\\\"offset\\\":1287},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":275,\\\"offset\\\":1413},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":1,\\\"offset\\\":1139},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":275,\\\"offset\\\":1413},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"La seconde solution a donc été de modifier le StatsdBundle et d'ajouter une configuration au niveau de l'événement pour forcer l'envoi instantané des données.\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":18,\\\"column\\\":1,\\\"offset\\\":1415},\\\"end\\\":{\\\"line\\\":18,\\\"column\\\":159,\\\"offset\\\":1573},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":18,\\\"column\\\":1,\\\"offset\\\":1415},\\\"end\\\":{\\\"line\\\":18,\\\"column\\\":159,\\\"offset\\\":1573},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Ainsi, avec la configuration suivante :\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":20,\\\"column\\\":1,\\\"offset\\\":1575},\\\"end\\\":{\\\"line\\\":20,\\\"column\\\":40,\\\"offset\\\":1614},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":20,\\\"column\\\":1,\\\"offset\\\":1575},\\\"end\\\":{\\\"line\\\":20,\\\"column\\\":40,\\\"offset\\\":1614},\\\"indent\\\":[]}},{\\\"type\\\":\\\"code\\\",\\\"lang\\\":\\\"yaml\\\",\\\"value\\\":\\\"clients:\\\\n    event:\\\\n        console.exception:\\\\n            increment:      mysite.command.<command.name>.exception\\\\n            immediate_send: true\\\\n        m6kernel.exception:\\\\n            increment: mysite.errors.<status_code>\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":22,\\\"column\\\":1,\\\"offset\\\":1616},\\\"end\\\":{\\\"line\\\":30,\\\"column\\\":4,\\\"offset\\\":1854},\\\"indent\\\":[1,1,1,1,1,1,1,1]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"L'incrément \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":1,\\\"offset\\\":1856},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":13,\\\"offset\\\":1868},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"mysite.command.<command.name>.exception\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":13,\\\"offset\\\":1868},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":54,\\\"offset\\\":1909},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" sera envoyé en temps réel, alors que les autres comme \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":54,\\\"offset\\\":1909},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":109,\\\"offset\\\":1964},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"mysite.errors.<status_code>\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":109,\\\"offset\\\":1964},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":138,\\\"offset\\\":1993},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" continueront à être envoyés pendant \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":138,\\\"offset\\\":1993},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":175,\\\"offset\\\":2030},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"kernel.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":175,\\\"offset\\\":2030},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":193,\\\"offset\\\":2048},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\".\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":193,\\\"offset\\\":2048},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":194,\\\"offset\\\":2049},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":1,\\\"offset\\\":1856},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":194,\\\"offset\\\":2049},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":1,\\\"column\\\":1,\\\"offset\\\":0},\\\"end\\\":{\\\"line\\\":33,\\\"column\\\":1,\\\"offset\\\":2050}}}\",\"frontmatter\":{\"date\":\"March 03, 2014\",\"path\":\"/2014-03-04-utilisation-du-statsdbundle-avec-la-console\",\"title\":\"Utilisation du StatsdBundle avec le composant Console\",\"image\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/2040dc0edba576fb1f3c921adb50bfbe-fe689.png\"}}}}}},\"pathContext\":{}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---2014-03-04-utilisation-du-statsdbundle-avec-la-console-0c546b3503199875b9f0.js","module.exports = {\"data\":{\"markdownRemark\":{\"ast\":\"{\\\"type\\\":\\\"root\\\",\\\"children\\\":[{\\\"type\\\":\\\"heading\\\",\\\"depth\\\":2,\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Le StatsdBundle\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":2,\\\"column\\\":4,\\\"offset\\\":4},\\\"end\\\":{\\\"line\\\":2,\\\"column\\\":19,\\\"offset\\\":19},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":2,\\\"column\\\":1,\\\"offset\\\":1},\\\"end\\\":{\\\"line\\\":2,\\\"column\\\":19,\\\"offset\\\":19},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Chez M6Web, nous \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":1,\\\"offset\\\":21},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":18,\\\"offset\\\":38},\\\"indent\\\":[]}},{\\\"type\\\":\\\"link\\\",\\\"title\\\":null,\\\"url\\\":\\\"{% post_url 2014-01-28-how-we-use-statsd %}\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"utilisons StatsD\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":19,\\\"offset\\\":39},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":35,\\\"offset\\\":55},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":18,\\\"offset\\\":38},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":81,\\\"offset\\\":101},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" et nous avons créé un \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":81,\\\"offset\\\":101},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":104,\\\"offset\\\":124},\\\"indent\\\":[]}},{\\\"type\\\":\\\"link\\\",\\\"title\\\":null,\\\"url\\\":\\\"https://github.com/M6Web/StatsdBundle\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"bundle\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":105,\\\"offset\\\":125},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":111,\\\"offset\\\":131},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":104,\\\"offset\\\":124},\\\"end\\\":{\\\"line\\\":4,\\\"column\\\":151,\\\"offset\\\":171},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" pour cela.\\\\nCe bundle permet d'ajouter facilement des incréments et des timings dans StatsD sur des événements Symfony2.\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":151,\\\"offset\\\":171},\\\"end\\\":{\\\"line\\\":5,\\\"column\\\":109,\\\"offset\\\":291},\\\"indent\\\":[1]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":4,\\\"column\\\":1,\\\"offset\\\":21},\\\"end\\\":{\\\"line\\\":5,\\\"column\\\":109,\\\"offset\\\":291},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"heading\\\",\\\"depth\\\":2,\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"De la Request à la console\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":7,\\\"column\\\":4,\\\"offset\\\":296},\\\"end\\\":{\\\"line\\\":7,\\\"column\\\":30,\\\"offset\\\":322},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":7,\\\"column\\\":1,\\\"offset\\\":293},\\\"end\\\":{\\\"line\\\":7,\\\"column\\\":30,\\\"offset\\\":322},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Or pour des raisons de performances, lors des événements Symfony, les incréments et timings sont seulement stockés dans une variable et ne sont envoyés réellement à StatsD que pendant le \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":1,\\\"offset\\\":324},\\\"end\\\":{\\\"line\\\":9,\\\"column\\\":188,\\\"offset\\\":511},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"kernel.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":188,\\\"offset\\\":511},\\\"end\\\":{\\\"line\\\":9,\\\"column\\\":206,\\\"offset\\\":529},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" qui se déroule après l'envoi de la réponse HTTP au client.\\\\nCeci pose un problème pour les événements lancés depuis une commande Symfony puisque en console, il n'y pas de \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":206,\\\"offset\\\":529},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":112,\\\"offset\\\":700},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"Request\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":112,\\\"offset\\\":700},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":121,\\\"offset\\\":709},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" et donc pas de \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":121,\\\"offset\\\":709},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":137,\\\"offset\\\":725},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"kernel.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":137,\\\"offset\\\":725},\\\"end\\\":{\\\"line\\\":10,\\\"column\\\":155,\\\"offset\\\":743},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\".\\\\nNous avons envisagé d'utiliser l'événement \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":10,\\\"column\\\":155,\\\"offset\\\":743},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":44,\\\"offset\\\":788},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"console.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":11,\\\"column\\\":44,\\\"offset\\\":788},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":63,\\\"offset\\\":807},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" pour palier à cela, mais cela pose deux problèmes :\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":11,\\\"column\\\":63,\\\"offset\\\":807},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":115,\\\"offset\\\":859},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":9,\\\"column\\\":1,\\\"offset\\\":324},\\\"end\\\":{\\\"line\\\":11,\\\"column\\\":115,\\\"offset\\\":859},\\\"indent\\\":[1,1]}},{\\\"type\\\":\\\"list\\\",\\\"ordered\\\":false,\\\"start\\\":null,\\\"loose\\\":false,\\\"children\\\":[{\\\"type\\\":\\\"listItem\\\",\\\"loose\\\":false,\\\"checked\\\":null,\\\"children\\\":[{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"pour une commande qui est censée tourner indéfiniment (par exemple un \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":3,\\\"offset\\\":863},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":73,\\\"offset\\\":933},\\\"indent\\\":[]}},{\\\"type\\\":\\\"emphasis\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"consumer\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":74,\\\"offset\\\":934},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":82,\\\"offset\\\":942},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":73,\\\"offset\\\":933},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":83,\\\"offset\\\":943},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"), on ne veut pas attendre la fin de la commande pour envoyer les données,\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":83,\\\"offset\\\":943},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":157,\\\"offset\\\":1017},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":3,\\\"offset\\\":863},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":157,\\\"offset\\\":1017},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":1,\\\"offset\\\":861},\\\"end\\\":{\\\"line\\\":13,\\\"column\\\":157,\\\"offset\\\":1017},\\\"indent\\\":[]}},{\\\"type\\\":\\\"listItem\\\",\\\"loose\\\":false,\\\"checked\\\":null,\\\"children\\\":[{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"dans le cas d'une exception pendant la commande, l'événement \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":3,\\\"offset\\\":1020},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":64,\\\"offset\\\":1081},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"console.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":64,\\\"offset\\\":1081},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":83,\\\"offset\\\":1100},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" est lancé avant \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":83,\\\"offset\\\":1100},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":100,\\\"offset\\\":1117},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"console.exception\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":100,\\\"offset\\\":1117},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":119,\\\"offset\\\":1136},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\".\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":119,\\\"offset\\\":1136},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":3,\\\"offset\\\":1020},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":14,\\\"column\\\":1,\\\"offset\\\":1018},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":13,\\\"column\\\":1,\\\"offset\\\":861},\\\"end\\\":{\\\"line\\\":14,\\\"column\\\":120,\\\"offset\\\":1137},\\\"indent\\\":[1]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"La première solution était donc d'appeler manuellement \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":1,\\\"offset\\\":1139},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":56,\\\"offset\\\":1194},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"$container->get('m6_statsd')->send()\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":56,\\\"offset\\\":1194},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":94,\\\"offset\\\":1232},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" dans la commande ou dans un \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":94,\\\"offset\\\":1232},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":123,\\\"offset\\\":1261},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"ConsoleExceptionListener\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":123,\\\"offset\\\":1261},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":149,\\\"offset\\\":1287},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" mais cela nous fait perdre le principal intérêt du StatsdBundle à savoir le découplage entre la commande et le client StatsD.\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":149,\\\"offset\\\":1287},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":275,\\\"offset\\\":1413},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":16,\\\"column\\\":1,\\\"offset\\\":1139},\\\"end\\\":{\\\"line\\\":16,\\\"column\\\":275,\\\"offset\\\":1413},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"La seconde solution a donc été de modifier le StatsdBundle et d'ajouter une configuration au niveau de l'événement pour forcer l'envoi instantané des données.\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":18,\\\"column\\\":1,\\\"offset\\\":1415},\\\"end\\\":{\\\"line\\\":18,\\\"column\\\":159,\\\"offset\\\":1573},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":18,\\\"column\\\":1,\\\"offset\\\":1415},\\\"end\\\":{\\\"line\\\":18,\\\"column\\\":159,\\\"offset\\\":1573},\\\"indent\\\":[]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"Ainsi, avec la configuration suivante :\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":20,\\\"column\\\":1,\\\"offset\\\":1575},\\\"end\\\":{\\\"line\\\":20,\\\"column\\\":40,\\\"offset\\\":1614},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":20,\\\"column\\\":1,\\\"offset\\\":1575},\\\"end\\\":{\\\"line\\\":20,\\\"column\\\":40,\\\"offset\\\":1614},\\\"indent\\\":[]}},{\\\"type\\\":\\\"code\\\",\\\"lang\\\":\\\"yaml\\\",\\\"value\\\":\\\"clients:\\\\n    event:\\\\n        console.exception:\\\\n            increment:      mysite.command.<command.name>.exception\\\\n            immediate_send: true\\\\n        m6kernel.exception:\\\\n            increment: mysite.errors.<status_code>\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":22,\\\"column\\\":1,\\\"offset\\\":1616},\\\"end\\\":{\\\"line\\\":30,\\\"column\\\":4,\\\"offset\\\":1854},\\\"indent\\\":[1,1,1,1,1,1,1,1]}},{\\\"type\\\":\\\"paragraph\\\",\\\"children\\\":[{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\"L'incrément \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":1,\\\"offset\\\":1856},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":13,\\\"offset\\\":1868},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"mysite.command.<command.name>.exception\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":13,\\\"offset\\\":1868},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":54,\\\"offset\\\":1909},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" sera envoyé en temps réel, alors que les autres comme \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":54,\\\"offset\\\":1909},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":109,\\\"offset\\\":1964},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"mysite.errors.<status_code>\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":109,\\\"offset\\\":1964},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":138,\\\"offset\\\":1993},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\" continueront à être envoyés pendant \\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":138,\\\"offset\\\":1993},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":175,\\\"offset\\\":2030},\\\"indent\\\":[]}},{\\\"type\\\":\\\"inlineCode\\\",\\\"value\\\":\\\"kernel.terminate\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":175,\\\"offset\\\":2030},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":193,\\\"offset\\\":2048},\\\"indent\\\":[]}},{\\\"type\\\":\\\"text\\\",\\\"value\\\":\\\".\\\",\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":193,\\\"offset\\\":2048},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":194,\\\"offset\\\":2049},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":32,\\\"column\\\":1,\\\"offset\\\":1856},\\\"end\\\":{\\\"line\\\":32,\\\"column\\\":194,\\\"offset\\\":2049},\\\"indent\\\":[]}}],\\\"position\\\":{\\\"start\\\":{\\\"line\\\":1,\\\"column\\\":1,\\\"offset\\\":0},\\\"end\\\":{\\\"line\\\":33,\\\"column\\\":1,\\\"offset\\\":2050}}}\",\"frontmatter\":{\"date\":\"March 03, 2014\",\"path\":\"/2014-03-04-utilisation-du-statsdbundle-avec-la-console\",\"title\":\"Utilisation du StatsdBundle avec le composant Console\",\"image\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/2040dc0edba576fb1f3c921adb50bfbe-fe689.png\"}}}}}},\"pathContext\":{}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/2014-03-04-utilisation-du-statsdbundle-avec-la-console.json\n// module id = ./node_modules/json-loader/index.js!./.cache/json/2014-03-04-utilisation-du-statsdbundle-avec-la-console.json\n// module chunks = 7733466120289764000"],"sourceRoot":""}